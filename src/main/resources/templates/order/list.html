<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link th:href="@{/styles/css/main.css}" rel="stylesheet"/>
    <title>Title</title>
</head>
<body>

<div th:insert="~{menunavy::futher-nav(isEmployee=${true})}"></div>

<div class="container mt-4">
    <h2 class="mb-4">Orders</h2>

    <div class="table-responsive">
        <table class="table table-hover table-bordered">
            <thead class="table-light">
            <tr>
                <th th:text="#{general.title.id}" >ID</th>
                <th th:text="#{general.title.status}" >Status</th>
                <th th:text="#{object.order.client}" >Client</th>
                <th th:text="#{object.order.employee}" >Employee</th>
                <th></th>
                <th th:text="#{orders.total}" >Total</th>
                <th>Actions</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="ord : ${orders}" th:class="${ord.approved} ? 'table-success' : ''">
                <td th:text="${ord.id}"></td>
                <td>
                    <span th:if="${ord.status == T(com.epam.rd.autocode.assessment.appliances.model.enums.OrderStatus).PENDING}" th:text="#{order.status.PENDING}" ></span>
                    <span th:if="${ord.status == T(com.epam.rd.autocode.assessment.appliances.model.enums.OrderStatus).CONFIRMED}" th:text="#{order.status.CONFIRMED}" ></span>
                    <span th:if="${ord.status == T(com.epam.rd.autocode.assessment.appliances.model.enums.OrderStatus).CANCELLED_BY_CLIENT}" th:text="#{order.status.CANCELLED_BY_CLIENT}" ></span>
                    <span th:if="${ord.status == T(com.epam.rd.autocode.assessment.appliances.model.enums.OrderStatus).CANCELLED_BY_EMPLOYEE}" th:text="#{order.status.CANCELLED_BY_EMPLOYEE}" ></span>
                </td>
                <td th:text="${ord.client?.email} ?: 'N/A'"></td>
                <td th:text="${ord.employee?.email} ?: 'N/A'"></td>
                <td>
                    <ul class="list-unstyled">
                        <li th:each="row : ${ord.orderRowSet}">
                            <span th:text="${row.appliance.name}"></span> Ã—
                            <span th:text="${row.number}"></span> =
                            <span th:text="${row.amount}"></span>
                        </li>
                    </ul>
                </td>
                <td>
                    <strong th:text="${#aggregates.sum(ord.orderRowSet.![amount])}"></strong>
                </td>
                <td>
                    <div class="btn-group btn-group-sm" role="group">
                        <!-- Approve button -->
                        <a th:unless="${ord.approved}"
                           th:href="@{/internal/orders/{orderId}/approved(orderId=${ord.id})}"
                           class="btn btn-outline-success">
                            <i class="bi bi-check-circle"></i> <span th:text="#{general.btn.approve}" ></span>
                        </a>
                        <!-- Delete button -->
                        <a th:href="@{/internal/orders/{orderId}/delete(orderId=${ord.id})}"
                           class="btn btn-outline-danger">
                            <i class="bi bi-trash"></i> <span th:text="#{general.btn.delete}" ></span>
                        </a>
                    </div>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</div>


<div th:insert="~{footer::footer}"></div>
</body>
</html>